workflows:
  android-workflow:
    name: Android Build
    max_build_duration: 30
    instance_type: mac_mini_m1  # Use this for building APK on macOS
    environment:
      flutter: stable
      groups:
        - keystore_credentials
    scripts:
      - name: Set up Keystore
        script: |
          echo $CM_KEYSTORE | base64 --decode > /tmp/keystore.jks
      - name: Build APK
        script: |
          flutter build apk --release --split-per-abi
    artifacts:
      - build/app/outputs/flutter-apk/*.apk
